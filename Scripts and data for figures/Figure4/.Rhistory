mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq)) %>%
arrange(Var1 %in% "Others")
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character() %>% rev(), "Others"))
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families,breaks=occurrencesTE$Var1,labels=occurrencesTE$Var2) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq))
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character() %>% rev(), "Others"))
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq))
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character() %>% rev(), "Others"))
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq)) #%>%
#arrange(Var1 %in% "Others")
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character() %>% rev(), "Others"))
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq)) %>%
arrange(Var1 %in% "Others")
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character() %>% rev(), "Others"))
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families,breaks=occurrencesTE$Var1,labels=occurrencesTE$Var2) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq)) #%>%
#arrange(Var1 %in% "Others")
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character() %>% rev(), "Others"))
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families,breaks=occurrencesTE$Var1,labels=occurrencesTE$Var2) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq)) #%>%
#arrange(Var1 %in% "Others")
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character() %>% rev(), "Others"))
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE$Var1
occurrencesTE$Var2
occurrencesTE
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq)) #%>%
#arrange(Var1 %in% "Others")
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
#occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character() %>% rev(), "Others"))
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq)) %>%
arrange(Var1 %in% "Others")
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq))
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
occurrencesTE$Var1
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
n<-sum(occurrencesTE$Var1 == "Others")
occurrencesTE$Var2 <- occurrencesTE$Var1
occurrencesTE[occurrencesTE$Var1=="Others",]$Var2 <- paste0("Others (",n,")")
occurrencesTE<-occurrencesTE %>% group_by(Var1,Var2) %>% summarise(Freq=sum(Freq))
occurrencesTE$Var1 <- factor(occurrencesTE$Var1, levels=c(occurrencesTE[occurrencesTE$Var1!="Others",] %>% arrange(.,Freq) %>% pull(Var1) %>%rev() %>% as.character(), "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Var1,Var2) %>%
mutate(per=Freq/sum(occurrencesTE$Freq)) %>%
arrange(desc(Freq))
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
f4b<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Var1)) + coord_polar("y", start=0) +
theme_void() + scale_fill_manual(values=color_map_families) + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b
TE_chim_global_TE_commonTE <- unique(TE_chim_global_TE[,c("FlyBaseGeneRef", "TEfamily")])
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<12,]$Var1 <- "Others"
occurrencesTE<-aggregate(occurrencesTE$Freq, by=list(Category=occurrencesTE$Var1), FUN=sum)
occurrencesTE
occurrencesTE<-aggregate(occurrencesTE$Freq, by=list(Category=occurrencesTE$Var1), FUN=sum)
#occurrencesTE$Category <- factor(occurrencesTE$Category, levels=c("INE-1", "Gypsy","Pao","P",  "TcMar-Tc1",  "Jockey", "LARD", "CMC-Transib", "R1", "TcMar-Pogo", "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTE$x)) %>%
arrange(desc(Category))
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
f4b_<-ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE TEfamily")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE TEfamily")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
TE_chim_global_TE_commonTE <- unique(TE_chim_global_TE[,c("FlyBaseGeneRef", "TEfamily")])
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE<-as.data.frame(table(TE_chim_global_TE_commonTE$TEfamily))
ggplot(occurrencesTE, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE$Var1<-as.character(occurrencesTE$Var1)
occurrencesTE[occurrencesTE$Freq<15,]$Var1 <- "Others"
occurrencesTE<-aggregate(occurrencesTE$Freq, by=list(Category=occurrencesTE$Var1), FUN=sum)
#occurrencesTE$Category <- factor(occurrencesTE$Category, levels=c("INE-1", "Gypsy","Pao","P",  "TcMar-Tc1",  "Jockey", "LARD", "CMC-Transib", "R1", "TcMar-Pogo", "Others"))
occurrencesTE<-occurrencesTE %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTE$x)) %>%
arrange(desc(Category))
occurrencesTE$label <- scales::percent(occurrencesTE$per)
occurrencesTE$label <- scales::percent(occurrencesTE$per, accuracy = 0.1)
ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE TEfamily")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
ggplot(occurrencesTE) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
TE_chim_global_TE_g1 <- TE_chim_global_TE[TE_chim_global_TE$group==1,]
TE_chim_global_TE_commonTE_g1 <- unique(TE_chim_global_TE_g1[,c("FlyBaseGeneRef", "SuperFamily")])
TE_chim_global_TE_commonTE_g1<-TE_chim_global_TE_commonTE_g1[,c("FlyBaseGeneRef", "SuperFamily")]
occurrencesTEg1<-as.data.frame(table(TE_chim_global_TE_commonTE_g1$SuperFamily))
ggplot(occurrencesTEg1, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg1<-as.data.frame(table(TE_chim_global_TE_commonTE_g1$SuperFamily))
ggplot(occurrencesTEg1, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg1$Var1<-as.character(occurrencesTEg1$Var1)
occurrencesTEg1[occurrencesTEg1$Freq<12,]$Var1 <- "Others"
occurrencesTEg1<-aggregate(occurrencesTEg1$Freq, by=list(Category=occurrencesTEg1$Var1), FUN=sum)
occurrencesTEg1<-occurrencesTEg1 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTEg1$x)) %>%
arrange(desc(Category))
occurrencesTEg1$label <- scales::percent(occurrencesTEg1$per)
occurrencesTEg1$label <- scales::percent(occurrencesTEg1$per, accuracy = 0.1)
f4b_g1<-ggplot(occurrencesTEg1) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE superfamily")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g1
TE_chim_global_TE_g1 <- TE_chim_global_TE[TE_chim_global_TE$group==1,]
TE_chim_global_TE_commonTE_g1 <- unique(TE_chim_global_TE_g1[,c("FlyBaseGeneRef", "TEfamily")])
TE_chim_global_TE_commonTE_g1<-TE_chim_global_TE_commonTE_g1[,c("FlyBaseGeneRef", "TEfamily")]
occurrencesTEg1<-as.data.frame(table(TE_chim_global_TE_commonTE_g1$TEfamily))
ggplot(occurrencesTEg1, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg1<-as.data.frame(table(TE_chim_global_TE_commonTE_g1$TEfamily))
ggplot(occurrencesTEg1, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg1$Var1<-as.character(occurrencesTEg1$Var1)
occurrencesTEg1[occurrencesTEg1$Freq<12,]$Var1 <- "Others"
occurrencesTEg1<-aggregate(occurrencesTEg1$Freq, by=list(Category=occurrencesTEg1$Var1), FUN=sum)
occurrencesTEg1<-occurrencesTEg1 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTEg1$x)) %>%
arrange(desc(Category))
occurrencesTEg1$label <- scales::percent(occurrencesTEg1$per)
occurrencesTEg1$label <- scales::percent(occurrencesTEg1$per, accuracy = 0.1)
f4b_g1<-ggplot(occurrencesTEg1) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE superfamily")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g1
f4b_g1<-ggplot(occurrencesTEg1) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g1
TE_chim_global_TE_g2 <- TE_chim_global_TE[TE_chim_global_TE$group==2,]
TE_chim_global_TE_commonTE_g2 <- unique(TE_chim_global_TE_g2[,c("FlyBaseGeneRef", "TEfamily")])
TE_chim_global_TE_commonTE_g2<-TE_chim_global_TE_commonTE_g2[,c("FlyBaseGeneRef", "TEfamily")]
occurrencesTEg2<-as.data.frame(table(TE_chim_global_TE_commonTE_g2$TEfamily))
ggplot(occurrencesTEg2, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg2<-as.data.frame(table(TE_chim_global_TE_commonTE_g2$TEfamily))
ggplot(occurrencesTEg2, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg2$Var1<-as.character(occurrencesTEg2$Var1)
occurrencesTEg2[occurrencesTEg2$Freq<12,]$Var1 <- "Others"
occurrencesTEg2<-aggregate(occurrencesTEg2$Freq, by=list(Category=occurrencesTEg2$Var1), FUN=sum)
occurrencesTEg2<-occurrencesTEg2 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTEg2$x)) %>%
arrange(desc(Category))
occurrencesTEg2$label <- scales::percent(occurrencesTEg2$per)
occurrencesTEg2$label <- scales::percent(occurrencesTEg2$per, accuracy = 0.1)
f4b_g2<-ggplot(occurrencesTEg2) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE superfamily")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g2
f4b_g2<-ggplot(occurrencesTEg2) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g2
TE_chim_global_TE_120 <- TE_chim_global_TE[TE_chim_global_TE$lengthTE>=120,]
TE_chim_global_TE_commonTE_120 <- unique(TE_chim_global_TE_120[,c("FlyBaseGeneRef", "TEfamily")])
TE_chim_global_TE_commonTE_120<-TE_chim_global_TE_commonTE_120[,c("FlyBaseGeneRef", "TEfamily")]
occurrencesTE_120<-as.data.frame(table(TE_chim_global_TE_commonTE_120$TEfamily))
ggplot(occurrencesTE_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE_120<-as.data.frame(table(TE_chim_global_TE_commonTE_120$TEfamily))
ggplot(occurrencesTE_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE_120$Var1<-as.character(occurrencesTE_120$Var1)
occurrencesTE_120[occurrencesTE_120$Freq<12,]$Var1 <- "Others"
occurrencesTE_120<-aggregate(occurrencesTE_120$Freq, by=list(Category=occurrencesTE_120$Var1), FUN=sum)
occurrencesTE_120<-occurrencesTE_120 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTE_120$x)) %>%
arrange(desc(Category))
occurrencesTE_120$label <- scales::percent(occurrencesTE_120$per)
occurrencesTE_120$label <- scales::percent(occurrencesTE_120$per, accuracy = 0.1)
f4b_120<-ggplot(occurrencesTE_120) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_120
TE_chim_global_TE_g1 <- TE_chim_global_TE[TE_chim_global_TE$group==1,]
TE_chim_global_TE_commonTE_g1 <- unique(TE_chim_global_TE_g1[,c("FlyBaseGeneRef", "TEfamily")])
TE_chim_global_TE_commonTE_g1<-TE_chim_global_TE_commonTE_g1[,c("FlyBaseGeneRef", "TEfamily")]
occurrencesTEg1<-as.data.frame(table(TE_chim_global_TE_commonTE_g1$TEfamily))
ggplot(occurrencesTEg1, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg1<-as.data.frame(table(TE_chim_global_TE_commonTE_g1$TEfamily))
ggplot(occurrencesTEg1, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg1$Var1<-as.character(occurrencesTEg1$Var1)
occurrencesTEg1[occurrencesTEg1$Freq<15,]$Var1 <- "Others"
occurrencesTEg1<-aggregate(occurrencesTEg1$Freq, by=list(Category=occurrencesTEg1$Var1), FUN=sum)
occurrencesTEg1<-occurrencesTEg1 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTEg1$x)) %>%
arrange(desc(Category))
occurrencesTEg1$label <- scales::percent(occurrencesTEg1$per)
occurrencesTEg1$label <- scales::percent(occurrencesTEg1$per, accuracy = 0.1)
f4b_g1<-ggplot(occurrencesTEg1) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g1
TE_chim_global_TE_g2 <- TE_chim_global_TE[TE_chim_global_TE$group==2,]
TE_chim_global_TE_commonTE_g2 <- unique(TE_chim_global_TE_g2[,c("FlyBaseGeneRef", "TEfamily")])
TE_chim_global_TE_commonTE_g2<-TE_chim_global_TE_commonTE_g2[,c("FlyBaseGeneRef", "TEfamily")]
occurrencesTEg2<-as.data.frame(table(TE_chim_global_TE_commonTE_g2$TEfamily))
ggplot(occurrencesTEg2, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg2<-as.data.frame(table(TE_chim_global_TE_commonTE_g2$TEfamily))
ggplot(occurrencesTEg2, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg2$Var1<-as.character(occurrencesTEg2$Var1)
occurrencesTEg2[occurrencesTEg2$Freq<15,]$Var1 <- "Others"
occurrencesTEg2<-aggregate(occurrencesTEg2$Freq, by=list(Category=occurrencesTEg2$Var1), FUN=sum)
occurrencesTEg2<-occurrencesTEg2 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTEg2$x)) %>%
arrange(desc(Category))
occurrencesTEg2$label <- scales::percent(occurrencesTEg2$per)
occurrencesTEg2$label <- scales::percent(occurrencesTEg2$per, accuracy = 0.1)
f4b_g2<-ggplot(occurrencesTEg2) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g2
TE_chim_global_TE_120 <- TE_chim_global_TE[TE_chim_global_TE$lengthTE>=120,]
TE_chim_global_TE_commonTE_120 <- unique(TE_chim_global_TE_120[,c("FlyBaseGeneRef", "TEfamily")])
TE_chim_global_TE_commonTE_120<-TE_chim_global_TE_commonTE_120[,c("FlyBaseGeneRef", "TEfamily")]
occurrencesTE_120<-as.data.frame(table(TE_chim_global_TE_commonTE_120$TEfamily))
ggplot(occurrencesTE_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE_120<-as.data.frame(table(TE_chim_global_TE_commonTE_120$TEfamily))
ggplot(occurrencesTE_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTE_120$Var1<-as.character(occurrencesTE_120$Var1)
occurrencesTE_120[occurrencesTE_120$Freq<15,]$Var1 <- "Others"
occurrencesTE_120<-aggregate(occurrencesTE_120$Freq, by=list(Category=occurrencesTE_120$Var1), FUN=sum)
occurrencesTE_120<-occurrencesTE_120 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTE_120$x)) %>%
arrange(desc(Category))
occurrencesTE_120$label <- scales::percent(occurrencesTE_120$per)
occurrencesTE_120$label <- scales::percent(occurrencesTE_120$per, accuracy = 0.1)
f4b_120<-ggplot(occurrencesTE_120) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_120
TE_chim_global_TE_g1_120 <- TE_chim_global_TE[TE_chim_global_TE$group==1 & TE_chim_global_TE$lengthTE>=120,]
TE_chim_global_TE_commonTE_g1_120 <- unique(TE_chim_global_TE_g1_120[,c("FlyBaseGeneRef", "TEfamily")])
TE_chim_global_TE_commonTE_g1_120<-TE_chim_global_TE_commonTE_g1_120[,c("FlyBaseGeneRef", "TEfamily")]
occurrencesTEg1_120<-as.data.frame(table(TE_chim_global_TE_commonTE_g1_120$TEfamily))
ggplot(occurrencesTEg1_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg1_120<-as.data.frame(table(TE_chim_global_TE_commonTE_g1_120$TEfamily))
ggplot(occurrencesTEg1_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg1_120$Var1<-as.character(occurrencesTEg1_120$Var1)
occurrencesTEg1_120[occurrencesTEg1_120$Freq<15,]$Var1 <- "Others"
occurrencesTEg1_120<-aggregate(occurrencesTEg1_120$Freq, by=list(Category=occurrencesTEg1_120$Var1), FUN=sum)
occurrencesTEg1_120<-occurrencesTEg1_120 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTEg1_120$x)) %>%
arrange(desc(Category))
occurrencesTEg1_120$label <- scales::percent(occurrencesTEg1_120$per)
occurrencesTEg1_120$label <- scales::percent(occurrencesTEg1_120$per, accuracy = 0.1)
f4b_g1_120<-ggplot(occurrencesTEg1_120) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g1_120
TE_chim_global_TE_g2_120 <- TE_chim_global_TE[TE_chim_global_TE$group==2 & TE_chim_global_TE$lengthTE>=120,]
TE_chim_global_TE_commonTE_g2_120 <- unique(TE_chim_global_TE_g2_120[,c("FlyBaseGeneRef", "SuperFamily")])
TE_chim_global_TE_commonTE_g2_120<-TE_chim_global_TE_commonTE_g2_120[,c("FlyBaseGeneRef", "SuperFamily")]
occurrencesTEg2_120<-as.data.frame(table(TE_chim_global_TE_commonTE_g2_120$SuperFamily))
ggplot(occurrencesTEg2_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg2_120<-as.data.frame(table(TE_chim_global_TE_commonTE_g2_120$SuperFamily))
ggplot(occurrencesTEg2_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg2_120$Var1<-as.character(occurrencesTEg2_120$Var1)
occurrencesTEg2_120[occurrencesTEg2_120$Freq<15,]$Var1 <- "Others"
occurrencesTEg2_120<-aggregate(occurrencesTEg2_120$Freq, by=list(Category=occurrencesTEg2_120$Var1), FUN=sum)
occurrencesTEg2_120<-occurrencesTEg2_120 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTEg2_120$x)) %>%
arrange(desc(Category))
occurrencesTEg2_120$label <- scales::percent(occurrencesTEg2_120$per)
occurrencesTEg2_120$label <- scales::percent(occurrencesTEg2_120$per, accuracy = 0.1)
f4b_g2_120<-ggplot(occurrencesTEg2_120) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE superfamily")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g2_120
occurrencesTEg2_120
TE_chim_global_TE_g2_120 <- TE_chim_global_TE[TE_chim_global_TE$group==2 & TE_chim_global_TE$lengthTE>=120,]
TE_chim_global_TE_commonTE_g2_120 <- unique(TE_chim_global_TE_g2_120[,c("FlyBaseGeneRef", "TEfamily")])
TE_chim_global_TE_commonTE_g2_120<-TE_chim_global_TE_commonTE_g2_120[,c("FlyBaseGeneRef", "TEfamily")]
occurrencesTEg2_120<-as.data.frame(table(TE_chim_global_TE_commonTE_g2_120$TEfamily))
ggplot(occurrencesTEg2_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg2_120<-as.data.frame(table(TE_chim_global_TE_commonTE_g2_120$TEfamily))
ggplot(occurrencesTEg2_120, aes(x=Var1,y=Freq)) + geom_col()
occurrencesTEg2_120$Var1<-as.character(occurrencesTEg2_120$Var1)
occurrencesTEg2_120[occurrencesTEg2_120$Freq<15,]$Var1 <- "Others"
occurrencesTEg2_120<-aggregate(occurrencesTEg2_120$Freq, by=list(Category=occurrencesTEg2_120$Var1), FUN=sum)
occurrencesTEg2_120<-occurrencesTEg2_120 %>%
group_by(Category) %>%
mutate(per=x/sum(occurrencesTEg2_120$x)) %>%
arrange(desc(Category))
occurrencesTEg2_120$label <- scales::percent(occurrencesTEg2_120$per)
occurrencesTEg2_120$label <- scales::percent(occurrencesTEg2_120$per, accuracy = 0.1)
f4b_g2_120<-ggplot(occurrencesTEg2_120) + geom_col(width=1, aes(x="",y=per,fill=Category)) + coord_polar("y", start=0) +
theme_void() + scale_fill_rickandmorty() + geom_label_repel(aes(x="",y= cumsum(per) - per/2,label = label), size=4, show.legend = F, max.overlaps = 15, nudge_x = 0.1)  +  theme(plot.title = element_text(face = "bold")) +
theme(plot.title = element_text(hjust = 0.5)) + labs(fill="TE family")  +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), text = element_text(size=16), plot.title = element_text(size = 16))
f4b_g2_120
